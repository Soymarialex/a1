<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Matching Game</title>
    <!-- Carga de Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Definici√≥n de colores centrales */
        :root {
            --flamingo-pink: #FF79AC;
            --eerie-black: #121118;
            /* Colores de estado */
            --light-pink: #FFE4F0; /* Rosa claro para estado inicial */
            --light-green: #C8E6C9; /* Verde claro para acierto */
            --light-red: #FFCDD2;   /* Rojo claro para error */
        }

        /* Estilo para emular Platform Medium Font y asegurar el color de texto */
        body {
            font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
            color: var(--eerie-black);
            background-color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        /* Estilo base de los botones para que sean peque√±os y tengan el borde inferior */
        .card-button {
            height: 48px; /* Altura fija para botones peque√±os */
            line-height: 1.2;
            padding: 0.5rem 0.75rem;
            border-bottom: 3px solid var(--flamingo-pink);
            background-color: var(--light-pink);
            color: var(--eerie-black);
            font-weight: 500;
            transition: background-color 0.1s ease-in-out, transform 0.1s;
        }

        .card-button:hover:not(.matched):not(.selected):not(.error) {
            background-color: #ffd8eb;
        }

        /* Estilo para los botones de nivel */
        .level-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%; /* Bot√≥n circular */
            border: 2px solid var(--flamingo-pink);
            background-color: white;
            color: var(--eerie-black);
            font-weight: 600;
            transition: background-color 0.2s;
            cursor: pointer;
        }

        .level-btn.active {
            background-color: var(--flamingo-pink);
            color: white;
        }
        .level-btn:hover:not(.active) {
            background-color: #f7f7f7;
        }
        
        /* Estados del juego */
        .selected {
            background-color: var(--flamingo-pink) !important;
            color: white !important;
        }

        .matched {
            background-color: var(--light-green) !important;
            border-bottom: 3px solid #81C784 !important; /* Un verde m√°s oscuro para el borde */
            cursor: default;
        }

        .error {
            background-color: var(--light-red) !important;
            border-bottom: 3px solid #E57373 !important; /* Un rojo m√°s oscuro para el borde */
        }

        /* T√≠tulos */
        .main-title {
            color: var(--eerie-black);
        }

        .primary-color {
            color: var(--flamingo-pink);
        }
    </style>
</head>
<body class="p-4">

    <div class="w-full max-w-xl mx-auto flex flex-col items-center">
        
        <!-- T√≠tulo principal -->
        <h1 class="text-4xl sm:text-5xl font-extrabold text-center mt-6 mb-2 main-title">
            Matching game
        </h1>

        <!-- Subt√≠tulo -->
        <h2 class="text-xl sm:text-2xl font-semibold text-center mb-8 primary-color">
            test your memory
        </h2>

        <!-- Contenedor de Botones de Nivel (NUEVO) -->
        <div id="level-buttons" class="flex flex-wrap justify-center gap-2 mb-6">
            <!-- Los botones se insertar√°n aqu√≠ por JavaScript -->
        </div>

        <!-- Indicador de Nivel y Puntuaci√≥n -->
        <div id="status" class="mb-6 text-lg font-bold text-center">
            Nivel: <span id="level-display">1</span> / 6
        </div>

        <!-- Contenedor del juego de 2 columnas -->
        <div id="game-container" class="grid grid-cols-2 gap-3 w-full max-w-lg">
            <!-- Las tarjetas se insertar√°n aqu√≠ por JavaScript -->
        </div>

        <!-- Mensaje de Fin del Juego (Oculto inicialmente) -->
        <div id="completion-message" class="hidden mt-12 text-center p-6 bg-pink-100 rounded-xl shadow-lg border-2 border-pink-400">
            <p class="text-2xl font-bold primary-color">¬°Felicidades! üéâ</p>
            <p class="text-lg main-title">Has completado todos los niveles.</p>
        </div>

    </div>

    <script>
        const FLAMINGO_PINK = '#FF79AC';
        const EERIE_BLACK = '#121118';
        
        // Datos de vocabulario agrupados en 6 niveles (7 pares por nivel)
        const LEVELS_DATA = [
            {
                es: ["el tipo", "el dinero", "los huevos", "la mantequilla", "el jugo de naranja", "la mermelada", "la leche"],
                en: ["kind, type", "money", "eggs", "butter", "orange juice", "jam", "milk"]
            },
            {
                es: ["el cereal", "el pan", "el pan tostado", "el tocino", "tostar", "hacer un brindis", "funcionar"],
                en: ["cereal", "bread", "toast", "bacon", "to toast", "to make a toast", "to work, to function"]
            },
            {
                es: ["el refresco", "la pasta", "la sopa", "la papa", "los frijoles", "el arroz", "el jam√≥n"],
                en: ["soft drink", "pasta", "soup", "potato", "beans", "rice", "ham"]
            },
            {
                es: ["el pavo", "el postre", "el queso", "salado", "bastante", "cierto", "despacio"],
                en: ["turkey", "dessert", "cheese", "salty", "rather, quite", "certain", "slowly"]
            },
            {
                es: ["claro", "probablemente", "todav√≠a", "a lo mejor", "afortunadamente", "bien", "inmediatamente"],
                en: ["clear", "probably", "still", "maybe", "fortunately", "well", "immediately"]
            },
            {
                es: ["mal", "actualmente", "como", "realmente", "as√≠", "cuidadoso", "demasiado"],
                en: ["poorly", "at present", "like, as", "actually", "so, like this", "careful", "too much"]
            }
        ];

        let currentLevel = 0;
        let selectedCard = null;
        let isChecking = false;
        let matchedCount = 0;
        
        const gameContainer = document.getElementById('game-container');
        const levelDisplay = document.getElementById('level-display');
        const completionMessage = document.getElementById('completion-message');
        const levelButtonsContainer = document.getElementById('level-buttons');

        /**
         * Funci√≥n para mezclar un array.
         * @param {Array<any>} array - El array a mezclar.
         * @returns {Array<any>} - El array mezclado.
         */
        const shuffleArray = (array) => {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        };
        
        /**
         * Crea los botones de navegaci√≥n de nivel.
         */
        const createLevelButtons = () => {
            levelButtonsContainer.innerHTML = '';
            LEVELS_DATA.forEach((_, index) => {
                const button = document.createElement('button');
                button.textContent = index + 1;
                button.dataset.level = index;
                button.className = 'level-btn';
                button.onclick = () => {
                    if (isChecking) return;
                    currentLevel = index;
                    loadLevel();
                };
                levelButtonsContainer.appendChild(button);
            });
        };


        /**
         * Inicializa o avanza el juego al nivel actual.
         */
        const loadLevel = () => {
            if (currentLevel >= LEVELS_DATA.length) {
                // Fin del juego
                gameContainer.innerHTML = '';
                completionMessage.classList.remove('hidden');
                // Asegurar que ning√∫n bot√≥n de nivel est√© activo
                document.querySelectorAll('.level-btn').forEach(btn => btn.classList.remove('active'));
                return;
            }

            // Actualizar el bot√≥n de nivel activo
            document.querySelectorAll('.level-btn').forEach(btn => {
                btn.classList.toggle('active', parseInt(btn.dataset.level) === currentLevel);
            });

            const levelData = LEVELS_DATA[currentLevel];
            const pairs = levelData.es.map((word, index) => ({
                es: word,
                en: levelData.en[index],
                matchId: index 
            }));

            // Creamos un array combinado para las palabras y sus traducciones, con su ID de emparejamiento.
            const spanishCards = pairs.map(p => ({ word: p.es, id: p.matchId, lang: 'es' }));
            const englishCards = pairs.map(p => ({ word: p.en, id: p.matchId, lang: 'en' }));

            // Mezclamos cada columna independientemente.
            const shuffledSpanish = shuffleArray(spanishCards);
            const shuffledEnglish = shuffleArray(englishCards);

            // Reseteamos el estado del juego
            gameContainer.innerHTML = '';
            selectedCard = null;
            isChecking = false;
            matchedCount = 0;
            levelDisplay.textContent = currentLevel + 1;
            completionMessage.classList.add('hidden');

            // Creamos los botones y los adjuntamos al DOM en las dos columnas
            const leftColumn = document.createElement('div');
            const rightColumn = document.createElement('div');
            leftColumn.className = 'flex flex-col space-y-3';
            rightColumn.className = 'flex flex-col space-y-3';

            // El juego requiere 7 palabras por nivel, as√≠ que iteramos 7 veces
            for (let i = 0; i < shuffledSpanish.length; i++) {
                // Bot√≥n de la columna izquierda (Espa√±ol)
                const btnEs = createCardButton(shuffledSpanish[i]);
                leftColumn.appendChild(btnEs);

                // Bot√≥n de la columna derecha (Ingl√©s)
                const btnEn = createCardButton(shuffledEnglish[i]);
                rightColumn.appendChild(btnEn);
            }

            gameContainer.appendChild(leftColumn);
            gameContainer.appendChild(rightColumn);
        };

        /**
         * Crea un elemento de bot√≥n para la tarjeta.
         * @param {Object} cardData - Datos de la palabra (word, id, lang).
         */
        const createCardButton = (cardData) => {
            const button = document.createElement('button');
            button.textContent = cardData.word;
            button.dataset.id = cardData.id;
            button.dataset.lang = cardData.lang;
            button.className = 'card-button rounded-md shadow-sm font-medium text-sm sm:text-base';
            button.onclick = handleCardClick;
            return button;
        };

        /**
         * L√≥gica de manejo de clics en las tarjetas.
         * @param {Event} event - El evento de clic.
         */
        const handleCardClick = (event) => {
            if (isChecking || event.target.classList.contains('matched')) {
                return;
            }

            const clickedCard = event.target;

            if (selectedCard) {
                // Segunda tarjeta seleccionada
                if (selectedCard === clickedCard || selectedCard.dataset.lang === clickedCard.dataset.lang) {
                    // Clic en la misma tarjeta o en el mismo idioma: deseleccionar
                    selectedCard.classList.remove('selected');
                    selectedCard = null;
                    return;
                }

                // Deshabilitar clics mientras se comprueba
                isChecking = true;
                clickedCard.classList.add('selected');

                // Comprobar emparejamiento
                if (selectedCard.dataset.id === clickedCard.dataset.id) {
                    // ¬°Acierto!
                    selectedCard.classList.remove('selected');
                    clickedCard.classList.remove('selected');

                    selectedCard.classList.add('matched');
                    clickedCard.classList.add('matched');
                    
                    selectedCard = null;
                    isChecking = false;
                    matchedCount++;

                    // Comprobar si se complet√≥ el nivel
                    if (matchedCount === LEVELS_DATA[currentLevel].es.length) {
                        currentLevel++;
                        loadLevel(); // Cargar el siguiente nivel inmediatamente
                    }

                } else {
                    // Error
                    selectedCard.classList.add('error');
                    clickedCard.classList.add('error');

                    setTimeout(() => {
                        selectedCard.classList.remove('selected', 'error');
                        clickedCard.classList.remove('selected', 'error');
                        selectedCard = null;
                        isChecking = false;
                    }, 800); // 800ms de error (rojo claro)
                }

            } else {
                // Primera tarjeta seleccionada
                selectedCard = clickedCard;
                selectedCard.classList.add('selected');
            }
        };

        // Iniciar el juego autom√°ticamente al cargar la ventana
        window.onload = () => {
            createLevelButtons();
            loadLevel();
        };

    </script>
</body>
</html>